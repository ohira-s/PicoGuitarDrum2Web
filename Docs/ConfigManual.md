# Pico Guitar & Drum Configuration Manual

## 1. GM音源名リスト 
### 1-1. ファイル
・SYNTH/MIDIFILE/GM0.TXT　　

	GM音源の楽器の名称を設定したファイルです。デフォルトの設定でよければ変更する必要はありません。  

### 1-2. フォーマット
　GM音源プログラム番号0〜127の楽器名を一行毎に記述します。ASCIIコードのみ使用可能です。  

```
Acostic Grand Piano  
Bright Acostic Piano  
Electric Grand Piano  
    :  
Gun Shot  
```

## 2. Pico Guitar & Drum楽器リスト
### 2-1. ファイル
・SYNTH/MIDIFILE/instruments.json  

	Pico Guitar & Drum内で選択できる楽器を列挙したJSON配列です。  
	デフォルトではギター系の楽器のみを列挙しています。この設定でよければ変更する必要はありません。  

### 2-2. フォーマット
　先頭は必ず-1とし、それ以降にGM音源のプログラム番号を列挙します。  
```
[-1, 24, 25, 26, 27, 28, 29, 30, 31, 104, 105, 106, 107]  
```

## 3. ドラム楽器リスト
### 3-1. ファイル
・SYNTH/MIDIFILE/drums.json  

	Pico Guitar & Drum内でドラム系の楽器として使用できるGM音源のプログラムを記述したJSON配列です。  
	デフォルトの設定でよければ変更する必要はありません。  

### 3-2. フォーマット
　GM音源ではMIDI 10チャンネルがドラム演奏用になっていて、ノート番号がドラム用楽器名に紐づけられています。このファイルではその関係を定義します。配列の要素が1つの楽器に相当し、辞書データで"NOTE"がノート番号、"NAME"が楽器名です。 
 
```
[  
  {"NOTE": 35, "NAME": "Acoustic Bass Drum"},  
  {"NOTE": 36, "NAME": "Bass Drum 1"},  
         :  
  {"NOTE": 81, "NAME": "Open Triangle"}  
]    
```

## 4. コード定義
### 4-1. ファイル
・SYNTH/MIDIFILE/chords.json  

	コード演奏時のギターの弦の押さえ方を定義します。デフォルトの設定でよければ変更する必要はありません。  

### 4-2. フォーマット
　以下の3つの要素を持つ辞書データです。  

```
{  
  "CHORDS": [コード記号定義],  
  "STRING_NOTES": [開放弦の音程定義],  
  "CHORD_DEFINITIONS": [コードの押さえ方定義]  
}  
```

#### 4-2-1. コード記号定義

```
"CHORDS": ["M", "M7", "7", ..., "dim7"]  
```
　コードを表す記号を列挙します。  

#### 4-2-2. 開放弦の音程定義

```
"STRING_NOTES": [16,11, 7, 2, -3, -8]  
```
　ギターの第1弦（高音側）〜6弦（低音側）の開放限の音程を、C4を0とした相対番号で指定します。第1弦の開放音はE5なので16、第6弦の開放音はE3なので-8です。  

#### 4-2-3. コードの押さえ方定義

```
"CHORD_DEFINITIONS": {  
  "CM": [[ 0, 1, 0, 2, 3,-1], [ 3, 5, 5, 5, 3,-1]],  
    :                       :  
  "Bdim7"  : [[-1, 3, 1, 3, 2,-1], [-1, 6, 7, 6,-1, 7]]  
}  
```

　C, C#, D, ...,Bの音階と、定義したコード記号を組み合わせたコード名（CM, CM7, ..., Bdim7）に対して、ギターのローコードとハイコードの押さえ方を定義します。  

```
"CM": [[ローコード], [ハイコード]]  
```
　ローコードとハイコードの配列は同じ構造で、第1弦〜第6弦の押さえるフレット番号を設定します。  

```
 -1: ミュート弦  
  0: 開放弦  
>=1: フレット番号  
```

　CMのローコード設定の[ 0, 1, 0, 2, 3,-1]は、第1弦は開放弦、第2弦は1フレット目を押さえる、...、第6弦はミュート弦であることを表しています。  

 　※コード定義を変更することで独自のコードやコードの押さえ方を設定できます。  

## 5. 起動時コード設定
### 5-1. ファイル
・SYNTH/MIDIFILE/switch.json  

	Pico Guitar & Drum起動時にコード選択スイッチS1〜S6に割り当てるコードを設定します。デフォルトの設定でよければ変更する必要はありません。  

### 5-2. フォーマット
　物理的なコード選択スイッチはS1〜S6の6個ですが、各スイッチで2つのコード設定を切り替えることができるため合計12個のスイッチを配列で設定します。  
　配列内の最初の6個が1セット目のスイッチ1〜6、後半の6個が2セット目のスイッチ1〜6です。各スイッチは以下の要素を持つ辞書データです。  

```
"ROOT": C〜Bを0〜11で表したベース音です。  
"CHORD": コード記号定義で定義したコード名の配列要素番号です（"M"なら0）  
"POSITION": ローコードなら0、ハイコードなら1です。  
"ON_NOTE": ON-NOTEコードの場合のベース音C〜Bを0〜11で指定します。  
"SCALE": オクターブを1〜9の範囲で指定します（通常は4です）  
```

## 6. コードセット定義
### 6-1. ファイル
・SYNTH/CHORD/CHORD_SET_NAME.json  
・SYNTH/CHORD/list.json  

　よく使うコードの組み合わせを定義してCHORD_SET_NAMEの部分に名前を付けて保存します。Pico Guitar & Drumのコード設定モードでこのコードセットファイルを指定することでChord Selectorsスイッチ（1〜6x2ページ=12個）にコードが割り当てられます。  
　list.jsonは、Pico Guitar & Drumが参照するコードセット定義ファイル群を列挙したリストファイルす。  
 
### 6-2. フォーマット
#### 6-2-1. コードセットファイル
　以下の2つの要素を持つ辞書データです。  

```
"NAME": "コードセット名",  
"CHRODS": [12個のコード設定]  
```

　コードセット名は単なる文字列です。  
　12個のコード設定は以下の配列が12個並んでいます。  

```
["ベース音", "コード記号", "ポジション", "ON-NOTEベース音", オクターブ]  
```


```
  "ベース音": C〜Bを0〜11で表したベース音です。  
  "コード記号": コード記号定義で定義したコード名の文字列です（M, M7, ..., dim7）  
  "ポジション": ローコードならLow、ハイコードならHighです。  
  "ON_NOTE": ON-NOTEコードの場合のベース音をC〜Bで指定します。  
  オクターブ: オクターブを1〜9の範囲で指定します（通常は4です）  
```

#### 6-2-2. リストファイル
　Pico Guitar & Drumで参照するコードセットファイル群を配列で設定します。コードセットファイルを作成しても、このリストファイルに登録していないとPico Guitar & Drumは認識しません。また、Pico Guitar & Drumはこのリストの順番通りにコードセットファイルを参照します。  

```
[  
  ["Canon.json", ""],  
  ["Simple.json", ""],  
  ["Sweet.json", ""],  
  ["Blues.json", ""]  
]  
```
　各要素の2番目の""はPico Guitar & Drumの内部データ構造に対応したものです。この通りに記述して下さい。  

## 7. ドラムセット定義
### 7-1. ファイル
・SYNTH/DRUM/DRUM_SET_NAME.json  
・SYNTH/DRUM/list.json  

　よく使うドラム系楽器の組み合わせを定義してDRUM\_SET\_NAMEの部分に名前を付けて保存します。Pico Guitar & Drumのコンフィギュレーションモードでこのドラムセットファイルを指定することでドラム用パッド（P1〜P6）にドラム楽器が割り当てられます。  
　list.jsonは、Pico Guitar & Drumが参照するドラムセット定義ファイル群を列挙したリストファイルす。  

### 7-2. フォーマット
#### 7-2-1. ドラムセットファイル
　以下の2つの要素を持つ辞書データです。  

```
"NAME": "ドラムセット名",  
"SET": [6個のドラム系楽器設定]  
```

　ドラムセット名は単なる文字列です。  
　6個のドラム系楽器設定は、ドラム楽器リスト内の番号をパッドP1〜P6まで列挙した配列です。  
　リスト内の楽器は先頭を0から数えます。MIDIのプログラム番号ではないので注意して下さい。例えば0なら{"NOTE": 35, "NAME": "Acoustic Bass Drum"}が割り当てられます。  
　ドラム系楽器を割り当てたくない場合は-1を設定します。この場合、そのパッドを押しても音は出ません。  

```
{"NAME": "Drum Set1", "SET": [1, 6, 3, 10, 11, 16]}  
```

#### 7-2-2. リストファイル
　Pico Guitar & Drumで参照するドラムセットファイル群を配列で設定します。ドラムセットファイルを作成しても、このリストファイルに登録していないとPico Guitar & Drumは認識しません。また、Pico Guitar & Drumはこのリストの順番通りにドラムドセットファイルを参照します。  

```
[  
  ["Drum1.json", ""],  
  ["Drum2.json", ""],  
  ["Drum3.json", ""],  
  ["Drum4.json", ""]  
]  
```
　各要素の2番目の""はPico Guitar & Drumの内部データ構造に対応したものです。この通りに記述して下さい。  

## 8. MUSICファイル
### 8-1. ファイル
・SYNTH/MUSIC/MUSIC_NAME.json　　
・SYNTH/MUSIC/list.json　　

　楽曲のコード進行を列挙してMUSIC_NAMEの部分に名前を付けてコード譜として保存します。Pico Guitar & DrumのMUSIC演奏モードでこのコード譜ファイルを指定することでワンボタン演奏ができます。  
　list.jsonは、Pico Guitar & Drumが参照するMUSICファイル群を列挙したリストファイルす。  

### 8-2. フォーマット
#### 8-2-1. MUSICファイル
　以下の2つの要素を持つ辞書データです。  

```
"NAME": "楽曲名",  
"MUSIC": [コード進行]  
```

　楽曲名は単なる文字列です。　　
　コード進行は演奏するコード群を以下の配列で列挙したデータです。  
```
["ベース音", "コード記号", "ポジション", "ON-NOTEベース音", オクターブ]  
```

```
  "ベース音": C〜Bを0〜11で表したベース音です。  
  "コード記号": コード記号定義で定義したコード名の文字列です（M, M7, ..., dim7）  
  "ポジション": ローコードならLow、ハイコードならHighです。  
  "ON_NOTE": ON-NOTEコードの場合のベース音をC〜Bで指定します。  
  オクターブ: オクターブを1〜9の範囲で指定します（通常は4です）  
```

　オプションで2つの文字列を配列の最後に記述することもできます。通常は歌詞と演奏タイミングを表した文字列を記述して演奏時の補助表示を行います。  

```
["ベース音", "コード記号", "ポジション", "ON-NOTEベース音", オクターブ, "歌詞", "演奏タイミング"]  

```
　例えば次の様なファイルになります。  

```
{  
  "NAME": "Sotsugyo Shashin",  
  "MUSIC":[  
    ["C", "M",  "LOW", "",  4, "Kanashi Koto",  
                               "    *   *"],  
    ["C", "M",  "LOW", "D", 4, "ga Aru",  
                               "*  *"],  
    ["G", "M7",	"LOW", "",  4, "to Hira-",  
                               "***"],  
    ["E", "m7",	"LOW", "",  4, "-ku Kawa",  
                               " *  *"],  
                  :  
    ["A", "m7", "LOW", "",  4, "Tokude",  
                               "* *"],  
    ["D", "7",  "LOW", "",  4, "Shikatte",  
                               "*    *"],  
    ["G", "M7", "LOW", "",  4, "...",  
                               "**"],  
    ["G", "7",  "LOW", "B", 4, "...",  
                               "*"]  
}  
```
　※歌詞と演奏タイミングは単なる文字列なので、ASCII文字であれば何を記述しても構いません。  

#### 8-2-2. リストファイル
　Pico Guitar & Drumで参照するMUSICファイル群を配列で設定します。MUSICファイルを作成しても、このリストファイルに登録していないとPico Guitar & Drumは認識しません。また、Pico Guitar & Drumはこのリストの順番通りにMUSICセットファイルを参照します。  

```
[  
    ["Yasashisa.json", ""],  
    ["Sotsugyo.json", ""],  
    ["Ellie.json", ""]  
]  
```
　各要素の2番目の""はPico Guitar & Drumの内部データ構造に対応したものです。この通りに記述して下さい。  
　
## 9. PICO2W環境設定ファイル
### 9-1. ファイル
・settings.toml  

	PICO2Wがcircuitpythonから参照する環境変数の設定ファイルです。  

### 9-2. フォーマット
#### 9-2-1. 環境変数設定ファイル
　環境変数名 = 値　の形式を列挙したテキストファイルです。  

```
CIRCUITPY_WIFI_SSID = "Your WiFi SSID"
CIRCUITPY_WIFI_PASSWORD = "Your WiFi Password"
PICO_IP_ADDRESS = "192.168.179.90"
PICO_NET_MASK = "255.255.255.0"
PICO_GATEWAY = "192.168.179.1"
PICO_WEB_PORT = "8080"
```

1) CIRCUITPY\_WIFI\_SSID  

	PICO2Wが接続するWiFIアクセスポイントのSSIDを記述します。  

2) CIRCUITPY\_WIFI\_PASSWORD  

	PICO2Wが接続するWiFIアクセスポイントのパスワードを記述します。  

3) PICO\_IP\_ADDRESS  

	PICO2Wの固定IPアドレスを記述します。  
	固定IPアドレスにすることで設定Webへのアクセスを容易にできます。  

4) PICO\_NET\_MASK  

	PICO2Wが接続するネットワークのサブネットマスクを記述します。  

5) PICO\_GATEWAY  

	PICO2Wが接続するネットワークのデフォルトゲートウェイを記述します。  

6) PICO\_WEB\_PORT  

	設定Web用のウェブサーバのポート番号を記述します。  